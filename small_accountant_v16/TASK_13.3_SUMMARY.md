# Task 13.3 完成总结：创建示例数据

## 任务概述

创建用于测试和演示的示例数据，包括交易记录、往来单位和Excel导入文件。

**需求引用**: Requirements 5.5

## 实施内容

### 1. 示例数据生成脚本

**文件**: `examples/generate_sample_data.py`

创建了完整的示例数据生成器，包含以下功能：

#### 1.1 往来单位生成
- **5个示例客户**：
  - 优质客户有限公司
  - 新兴科技股份有限公司
  - 长期合作伙伴公司
  - 稳定收入客户
  - 大型企业集团

- **5个示例供应商**：
  - 原材料供应商A
  - 设备租赁公司
  - 物流运输服务商
  - 办公用品供应商
  - 技术服务提供商

- **完整信息**：每个单位包含名称、联系人、电话、邮箱、地址、税号

#### 1.2 交易记录生成
- **30笔收入交易**：
  - 类别：产品销售、服务收入、咨询费、技术服务费、租金收入
  - 金额范围：5,000 - 50,000元

- **40笔支出交易**：
  - 类别：原材料采购、设备租赁、物流费用、办公费用、技术服务费、工资支出、水电费
  - 金额范围：1,000 - 30,000元

- **20笔订单交易**：
  - 类别：加工订单、定制服务、批量采购
  - 金额范围：10,000 - 100,000元
  - 状态：待处理或已完成

- **时间跨度**：最近3个月（90天）
- **总计**：90笔交易记录

#### 1.3 数据存储
- 保存到JSON格式：`examples/data/counterparties.json` 和 `examples/data/transactions.json`
- 使用标准存储类进行保存，确保数据格式一致

### 2. Excel导入文件

#### 2.1 示例往来单位.xlsx
- **内容**：10个往来单位（5个客户 + 5个供应商）
- **列**：单位名称、类型、联系人、电话、邮箱、地址、税号
- **样式**：蓝色表头，专业格式
- **用途**：测试往来单位导入功能

#### 2.2 示例交易记录.xlsx
- **内容**：50笔交易记录
- **列**：日期、类型、金额、往来单位、摘要、类别、状态
- **样式**：绿色表头，清晰布局
- **用途**：测试交易记录导入功能

#### 2.3 示例银行流水.xlsx
- **内容**：40笔银行流水记录
- **列**：交易日期、摘要、收入金额、支出金额、余额、对方户名
- **样式**：橙色表头，银行流水格式
- **初始余额**：500,000元
- **用途**：测试银行对账功能

### 3. 文档

**文件**: `examples/README.md`

创建了详细的使用说明文档，包含：
- 文件说明（数据文件和Excel文件）
- 使用方法（如何生成和使用示例数据）
- 数据特点（往来单位、交易记录、银行流水的详细说明）
- 注意事项（测试环境使用建议）
- 自定义方法（如何修改生成脚本）

## 技术实现

### 数据生成策略
```python
# 1. 使用预定义的示例单位列表
SAMPLE_CUSTOMERS = [...]  # 5个客户
SAMPLE_SUPPLIERS = [...]  # 5个供应商

# 2. 随机生成交易记录
- 随机日期（最近90天）
- 随机金额（根据交易类型）
- 随机类别
- 随机状态（订单）

# 3. 银行流水模拟
- 基于交易记录生成
- 计算累计余额
- 只包含收入和支出（不含订单）
```

### Excel文件生成
```python
# 使用openpyxl库
- 创建工作簿和工作表
- 设置表头样式（颜色、字体、对齐）
- 添加数据行
- 调整列宽
- 保存文件
```

### 存储集成
```python
# 使用标准存储类
counterparty_storage = CounterpartyStorage(data_dir)
transaction_storage = TransactionStorage(data_dir)

# 保存数据
for item in items:
    storage.add(item)
```

## 生成的文件

### 数据文件
1. `examples/data/counterparties.json` - 10个往来单位
2. `examples/data/transactions.json` - 90笔交易记录

### Excel文件
3. `examples/示例往来单位.xlsx` - 往来单位导入模板
4. `examples/示例交易记录.xlsx` - 交易记录导入模板
5. `examples/示例银行流水.xlsx` - 银行流水导入模板

### 文档
6. `examples/README.md` - 使用说明文档

### 脚本
7. `examples/generate_sample_data.py` - 数据生成脚本

## 使用方法

### 生成示例数据
```bash
# 在项目根目录运行
python small_accountant_v16/examples/generate_sample_data.py
```

### 测试场景

#### 1. 测试Excel导入功能
- 导入 `示例往来单位.xlsx` 测试往来单位导入
- 导入 `示例交易记录.xlsx` 测试交易记录导入
- 导入 `示例银行流水.xlsx` 测试银行流水导入

#### 2. 测试报表生成功能
- 使用示例数据生成管理报表
- 查看收支对比、利润趋势
- 生成客户排名图表

#### 3. 测试对账功能
- 使用银行流水进行对账
- 查看匹配结果和差异报告
- 生成客户对账单

#### 4. 测试提醒功能
- 基于示例交易生成应收应付提醒
- 测试现金流预警

## 数据特点

### 真实性
- 使用真实的中文公司名称格式
- 合理的联系方式格式
- 符合中国税号格式
- 真实的业务场景和类别

### 多样性
- 涵盖不同类型的往来单位
- 包含各种交易类型和类别
- 不同的金额范围
- 不同的交易状态

### 完整性
- 所有必填字段都有值
- 数据之间有关联（交易记录引用往来单位）
- 时间序列完整（最近3个月）
- 余额计算正确（银行流水）

### 可测试性
- 足够的数据量（90笔交易）
- 覆盖各种场景
- 便于验证功能正确性
- 易于理解和修改

## 验证结果

### 生成成功
```
✓ 生成了 10 个往来单位 (5 个客户, 5 个供应商)
✓ 生成了 90 笔交易记录 (30笔收入, 40笔支出, 20笔订单)
✓ 数据已保存到: examples/data
✓ Excel文件创建完成
✓ 创建了README文件
```

### 文件验证
- ✅ 所有JSON文件格式正确
- ✅ 所有Excel文件可以正常打开
- ✅ 数据内容完整且合理
- ✅ 文档说明清晰详细

## 可扩展性

### 自定义配置
用户可以通过修改脚本中的配置来自定义示例数据：

```python
# 修改往来单位列表
SAMPLE_CUSTOMERS = [...]
SAMPLE_SUPPLIERS = [...]

# 修改交易类别
INCOME_CATEGORIES = [...]
EXPENSE_CATEGORIES = [...]
ORDER_CATEGORIES = [...]

# 修改数据量
range(30)  # 收入交易数量
range(40)  # 支出交易数量
range(20)  # 订单交易数量

# 修改时间范围
timedelta(days=90)  # 最近90天

# 修改金额范围
random.randint(5000, 50000)  # 收入金额
random.randint(1000, 30000)  # 支出金额
```

### 添加新数据类型
脚本结构清晰，易于扩展：
- 添加新的往来单位类型
- 添加新的交易类别
- 生成其他类型的Excel文件
- 添加更多数据验证

## 总结

Task 13.3 已成功完成，创建了完整的示例数据系统：

1. ✅ **数据生成脚本**：功能完整，易于使用
2. ✅ **示例数据**：10个往来单位 + 90笔交易记录
3. ✅ **Excel文件**：3个专业格式的导入模板
4. ✅ **使用文档**：详细的说明和指导
5. ✅ **可扩展性**：易于自定义和扩展

示例数据覆盖了系统的所有核心功能，为测试和演示提供了完整的支持。用户可以直接使用这些数据快速体验系统功能，也可以根据需要自定义生成新的示例数据。

**下一步**：继续执行Task 14 - Final Checkpoint（最终验证）
