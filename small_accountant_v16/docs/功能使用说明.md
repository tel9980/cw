# V1.6 小会计实用增强版 - 功能使用说明

## 目录

1. [智能报表生成器](#1-智能报表生成器)
2. [智能提醒系统](#2-智能提醒系统)
3. [快速对账助手](#3-快速对账助手)
4. [Excel批量导入](#4-excel批量导入)
5. [系统配置](#5-系统配置)

---

## 1. 智能报表生成器

### 1.1 管理报表

**功能说明**：为企业管理层提供经营分析报表

**包含内容**：
- 收支对比分析
- 利润趋势图表
- 客户排名统计
- 供应商排名统计
- 现金流分析

**使用方法**：

```
主菜单 → 1. 智能报表生成 → 1. 管理报表
```

**参数设置**：
- **日期范围**：选择报表统计期间
- **输出格式**：Excel（自动生成图表）

**报表结构**：

| 工作表名称 | 内容说明 |
|-----------|---------|
| 概览 | 总体财务指标 |
| 收支明细 | 收入和支出详细列表 |
| 利润分析 | 利润趋势和构成 |
| 客户分析 | 客户贡献度排名 |
| 供应商分析 | 供应商采购统计 |
| 图表汇总 | 可视化图表集合 |

**示例输出**：

```
管理报表_2026-01-01至2026-12-31.xlsx

概览：
- 总收入：1,500,000元
- 总支出：1,200,000元
- 净利润：300,000元
- 利润率：20%

客户TOP5：
1. 客户A - 500,000元 (33.3%)
2. 客户B - 300,000元 (20.0%)
...
```

### 1.2 税务报表

**功能说明**：生成税务申报所需的报表

**包含内容**：
- 增值税申报表
- 所得税申报表
- 税金计算明细
- 进项税额统计
- 销项税额统计

**使用方法**：

```
主菜单 → 1. 智能报表生成 → 2. 税务报表
```

**参数设置**：
- **报税期间**：选择月度或季度
- **税率设置**：增值税率、所得税率

**报表结构**：

| 工作表名称 | 内容说明 |
|-----------|---------|
| 增值税申报表 | 标准增值税申报格式 |
| 所得税申报表 | 企业所得税申报格式 |
| 进项税明细 | 可抵扣进项税额 |
| 销项税明细 | 应缴销项税额 |
| 税金汇总 | 各税种汇总 |

**注意事项**：
- 确保交易记录已正确分类
- 检查税率设置是否正确
- 核对进项税发票是否齐全

### 1.3 银行贷款报表

**功能说明**：为银行贷款申请准备财务报表

**包含内容**：
- 资产负债表
- 利润表
- 现金流量表
- 财务指标分析
- 偿债能力分析

**使用方法**：

```
主菜单 → 1. 智能报表生成 → 3. 银行贷款报表
```

**参数设置**：
- **报表日期**：资产负债表截止日期
- **期间范围**：利润表和现金流量表期间

**报表结构**：

| 工作表名称 | 内容说明 |
|-----------|---------|
| 资产负债表 | 标准资产负债表格式 |
| 利润表 | 标准利润表格式 |
| 现金流量表 | 标准现金流量表格式 |
| 财务指标 | 关键财务比率 |
| 附注说明 | 报表附注和说明 |

**关键指标**：
- 流动比率
- 速动比率
- 资产负债率
- 净资产收益率
- 现金流量比率

---

## 2. 智能提醒系统

### 2.1 税务提醒

**功能说明**：自动提醒税务申报截止日期

**提醒时间**：
- 提前10天：首次提醒
- 提前5天：第二次提醒
- 提前3天：紧急提醒
- 当天：最后提醒

**提醒内容**：
```
🔔 税务申报提醒

类型：增值税申报
截止日期：2026-03-15
剩余天数：3天

请及时完成申报，避免逾期罚款。
```

**配置方法**：

```
主菜单 → 2. 智能提醒管理 → 1. 税务提醒设置
```

**可配置项**：
- 提醒天数（默认：10, 5, 3, 0）
- 通知渠道（桌面/企业微信）
- 提醒时间（默认：每天9:00）

### 2.2 应付账款提醒

**功能说明**：提醒供应商付款到期日

**提醒规则**：
- 提前7天：付款准备提醒
- 提前3天：付款确认提醒
- 当天：付款执行提醒
- 逾期：逾期付款警告

**提醒内容**：
```
💰 应付账款提醒

供应商：XX供应商
应付金额：50,000元
到期日期：2026-03-20
剩余天数：3天

请及时安排付款，维护供应商关系。
```

### 2.3 应收账款提醒

**功能说明**：提醒客户逾期账款并生成催款函

**提醒规则**：
- 逾期30天：首次催收（友好提醒）
- 逾期60天：二次催收（正式催收）
- 逾期90天：最后通知（法律警告）

**催款函生成**：

系统自动生成专业催款函Word文档：

```
催款函_客户名称_催收阶段_日期.docx
```

**催款函内容**：
- 首次提醒：友好语气，提醒付款
- 二次催收：正式语气，要求付款
- 最后通知：严肃语气，法律警告

**使用方法**：

```
主菜单 → 2. 智能提醒管理 → 3. 应收账款管理 → 生成催款函
```

### 2.4 现金流预警

**功能说明**：预测未来现金流，提前预警资金短缺

**预警规则**：
- 预测未来30天现金流
- 现金余额 < 安全线：发出预警
- 提供资金缺口和建议

**预警内容**：
```
⚠️  现金流预警

预测日期：2026-03-25
预计余额：-50,000元
资金缺口：50,000元

建议措施：
1. 加快应收账款回收
2. 延缓部分应付账款
3. 考虑短期融资
```

### 2.5 提醒调度配置

**功能说明**：配置提醒检查的时间和频率

**配置选项**：

| 配置项 | 说明 | 默认值 |
|-------|------|--------|
| 检查频率 | 每日/每周/每月 | 每日 |
| 检查时间 | 具体时间点 | 09:00 |
| 通知渠道 | 桌面/企业微信 | 桌面+企业微信 |
| 启用状态 | 开启/关闭 | 开启 |

**使用方法**：

```
主菜单 → 2. 智能提醒管理 → 5. 提醒调度设置
```

---

## 3. 快速对账助手

### 3.1 银行流水对账

**功能说明**：将银行流水与系统交易记录自动匹配

**对账流程**：

1. **准备银行流水**
   - 从银行下载流水Excel文件
   - 确保包含：日期、金额、对方账户、摘要

2. **导入流水**
   ```
   主菜单 → 3. 快速对账助手 → 1. 银行流水对账
   ```

3. **自动匹配**
   - 系统自动匹配交易记录
   - 支持模糊匹配（金额±1元，日期±3天）

4. **查看结果**
   ```
   对账结果：
   ✅ 已匹配：45笔（总额：500,000元）
   ⚠️  差异：3笔（总额：15,000元）
   ❌ 未匹配：2笔（总额：5,000元）
   ```

5. **处理差异**
   - 查看差异明细
   - 手动调整匹配
   - 补录遗漏交易

**匹配规则**：

| 匹配条件 | 容差范围 |
|---------|---------|
| 金额 | ±1元 |
| 日期 | ±3天 |
| 对方名称 | 模糊匹配 |

### 3.2 客户对账单

**功能说明**：生成客户往来对账单

**对账单内容**：
- 期初余额
- 本期发生额（收入/支出）
- 期末余额
- 明细交易列表

**使用方法**：

```
主菜单 → 3. 快速对账助手 → 2. 客户对账单
```

**参数设置**：
- 选择客户
- 选择日期范围
- 选择输出格式（Excel/HTML）

**对账单示例**：

```
客户对账单
客户名称：XX科技有限公司
对账期间：2026-01-01 至 2026-12-31

期初余额：0元
本期收入：500,000元
本期支出：450,000元
期末余额：50,000元

明细：
日期       | 摘要        | 收入    | 支出    | 余额
2026-01-15 | 销售收入    | 100,000 |         | 100,000
2026-02-20 | 收到货款    |         | 80,000  | 20,000
...
```

### 3.3 供应商对账

**功能说明**：核对供应商往来账款

**对账流程**：

1. 选择供应商
2. 选择对账期间
3. 系统生成对账单
4. 与供应商核对
5. 确认无误后签字盖章

**对账单格式**：与客户对账单类似

---

## 4. Excel批量导入

### 4.1 交易记录导入

**功能说明**：批量导入历史交易记录

**Excel模板**：

| 日期 | 类型 | 金额 | 往来单位 | 摘要 | 类别 | 状态 |
|------|------|------|---------|------|------|------|
| 2026-01-15 | 收入 | 10000 | 客户A | 销售收入 | 主营业务收入 | 已完成 |
| 2026-01-20 | 支出 | 5000 | 供应商B | 采购原材料 | 采购成本 | 已完成 |

**列名识别**：

系统智能识别以下列名变体：
- 日期：日期、时间、交易日期、发生日期
- 金额：金额、交易金额、发生额
- 类型：类型、交易类型、收支类型
- 往来单位：往来单位、对方单位、客户、供应商

**导入步骤**：

1. **准备Excel文件**
   - 使用模板或自定义格式
   - 确保数据完整

2. **预览导入**
   ```
   主菜单 → 4. Excel批量导入 → 1. 交易记录导入 → 预览
   ```

3. **验证数据**
   - 系统自动验证数据格式
   - 显示错误和警告

4. **确认导入**
   - 检查预览结果
   - 确认无误后导入

5. **查看结果**
   ```
   导入完成！
   成功：98条
   失败：2条
   
   失败原因：
   - 第15行：金额格式错误
   - 第67行：日期格式错误
   ```

**数据验证规则**：

| 字段 | 验证规则 |
|------|---------|
| 日期 | 必填，格式：YYYY-MM-DD |
| 金额 | 必填，大于0 |
| 类型 | 必填，收入/支出/订单 |
| 往来单位 | 必填，必须存在 |
| 状态 | 可选，默认"已完成" |

### 4.2 往来单位导入

**功能说明**：批量导入客户和供应商信息

**Excel模板**：

| 名称 | 类型 | 联系人 | 电话 | 邮箱 | 地址 | 税号 |
|------|------|--------|------|------|------|------|
| XX科技 | 客户 | 张三 | 138... | xxx@xx.com | 北京市... | 91110... |
| YY供应商 | 供应商 | 李四 | 139... | yyy@yy.com | 上海市... | 91310... |

**导入步骤**：与交易记录导入类似

### 4.3 导入历史管理

**功能说明**：查看和管理历史导入记录

**功能列表**：
- 查看导入历史
- 查看导入详情
- 撤销错误导入

**撤销导入**：

```
主菜单 → 4. Excel批量导入 → 3. 导入历史 → 撤销导入
```

**注意事项**：
- 只能撤销最近的导入
- 撤销后数据将被删除
- 撤销操作不可恢复

---

## 5. 系统配置

### 5.1 基本配置

**数据存储配置**：
- 数据目录：存储数据文件的位置
- 报表目录：生成报表的输出位置
- 备份目录：配置备份的存储位置

**使用方法**：

```
主菜单 → 5. 系统配置 → 1. 基本配置
```

### 5.2 提醒配置

**税务提醒配置**：
- 提醒天数：[10, 5, 3, 0]
- 检查间隔：30分钟
- 启用桌面通知：是/否
- 启用企业微信通知：是/否

**应收应付配置**：
- 应付提醒天数：[7, 3, 0]
- 应收逾期天数：[30, 60, 90]
- 现金流预警天数：30

### 5.3 企业微信配置

**配置步骤**：

1. **获取Webhook URL**
   - 登录企业微信管理后台
   - 创建群机器人
   - 复制Webhook URL

2. **配置系统**
   ```
   主菜单 → 5. 系统配置 → 3. 企业微信配置
   ```

3. **输入Webhook URL**
   ```
   请输入企业微信Webhook URL：
   https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxxx
   ```

4. **测试通知**
   ```
   是否发送测试通知？(y/n): y
   ✅ 测试通知发送成功！
   ```

### 5.4 配置备份与恢复

**自动备份**：
- 每次保存配置时自动备份
- 保留最近10个备份

**手动备份**：
```
主菜单 → 5. 系统配置 → 4. 备份管理 → 创建备份
```

**恢复配置**：
```
主菜单 → 5. 系统配置 → 4. 备份管理 → 恢复备份
```

**导出/导入配置**：
- 导出：将配置保存为JSON文件
- 导入：从JSON文件加载配置

---

## 附录

### A. 快捷键

| 快捷键 | 功能 |
|-------|------|
| 0 | 返回上级菜单 |
| q | 退出系统 |
| h | 显示帮助 |

### B. 数据格式说明

**日期格式**：YYYY-MM-DD（例如：2026-01-15）

**金额格式**：数字，支持小数点（例如：10000.50）

**交易类型**：
- 收入（INCOME）
- 支出（EXPENSE）
- 订单（ORDER）

**交易状态**：
- 待处理（PENDING）
- 已完成（COMPLETED）
- 已取消（CANCELLED）

### C. 常用命令

**运行系统**：
```bash
python small_accountant_v16/run_cli.py
```

**运行测试**：
```bash
python -m pytest small_accountant_v16/tests/ -v
```

**查看日志**：
```bash
cat logs/small_accountant_YYYYMMDD.log
```

---

**需要更多帮助？** 查看[常见问题解答](常见问题解答.md)
