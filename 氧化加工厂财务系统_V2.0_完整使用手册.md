# 氧化加工厂财务系统 V2.0 - 完整使用手册

> 版本：2.0 | 更新日期：2024-02

---

## 目录

1. [系统简介](#1-系统简介)
2. [安装部署](#2-安装部署)
3. [快速入门](#3-快速入门)
4. [客户管理](#4-客户管理)
5. [供应商管理](#5-供应商管理)
6. [订单管理](#6-订单管理)
7. [收入管理](#7-收入管理)
8. [支出管理](#8-支出管理)
9. [银行账户](#9-银行账户)
10. [财务报表](#10-财务报表)
11. [数据工具](#11-数据工具)
12. [常见问题](#12-常见问题)

---

## 1. 系统简介

### 1.1 什么是氧化加工厂财务系统？

专为**小型氧化加工厂**设计的财务管理软件，帮助您：

- 📋 管理客户和供应商
- 📦 跟踪加工订单
- 💰 记录收入和支出
- 🏦 管理银行账户
- 📊 生成财务报表

### 1.2 适用范围

| 行业 | 说明 |
|------|------|
| 五金氧化厂 | 铝材、不锈钢氧化加工 |
| 表面处理 | 电镀、氧化、喷涂 |
| 金属加工 | 来料加工、OEM |

### 1.3 核心功能

```
┌─────────────────────────────────────────────────────────────┐
│                    系统核心功能                              │
├─────────────┬─────────────┬─────────────┬───────────────────┤
│   订单管理   │   收支管理   │   银行管理   │     报表          │
├─────────────┼─────────────┼─────────────┼───────────────────┤
│ • 来料登记   │ • 客户收款   │ • G银行     │ • 利润表          │
│ • 工序跟踪   │ • 预收款     │ • N银行     │ • 成本分析        │
│ • 委外加工   │ • 原料采购   │ • 流水对账   │ • 客户对账单      │
│ • 计价计算   │ • 费用支出   │ • 资金监控   │ • 供应商对账单    │
└─────────────┴─────────────┴─────────────┴───────────────────┘
```

---

## 2. 安装部署

### 2.1 系统要求

| 项目 | 要求 |
|------|------|
| 操作系统 | Windows 7+ / macOS / Linux |
| Python | 3.8 或更高版本 |
| 内存 | 最低 2GB，推荐 4GB |
| 硬盘 | 至少 100MB 可用空间 |

### 2.2 安装步骤

#### 方法一：一键安装（推荐）

```bash
# 1. 下载并解压
unzip oxidation_finance_v2.0.zip
cd oxidation_finance_v2.0

# 2. 双击运行
start.bat   # Windows
./start.sh  # Linux/macOS
```

#### 方法二：手动安装

```bash
# 1. 创建虚拟环境
python -m venv venv
venv\Scripts\activate   # Windows
source venv/bin/activate  # Linux/macOS

# 2. 安装依赖
pip install -r requirements.txt

# 3. 初始化数据
python oxidation_finance_v20/tools/setup_wizard.py

# 4. 启动系统
python 氧化加工厂财务助手_V2.0_完整版.py
```

### 2.3 目录结构

```
oxidation_finance_v2.0/
├── 氧化加工厂财务助手_V2.0_完整版.py  # 主程序
├── 启动_氧化加工厂财务系统_V2.0.bat   # 一键启动
├── oxidation_finance_v20/
│   ├── oxidation_finance_demo_ready.db  # 数据库
│   ├── tools/
│   │   ├── setup_wizard.py             # 初始化向导
│   │   ├── import_excel.py             # 数据导入
│   │   └── backup_restore.py           # 备份恢复
│   ├── examples/
│   │   └── generate_comprehensive_demo.py  # 示例数据
│   └── ...
├── docs/                               # 文档
└── backups/                            # 自动备份
```

---

## 3. 快速入门

### 3.1 首次使用

#### 步骤1：运行初始化向导

```bash
python oxidation_finance_v20/tools/setup_wizard.py
```

向导会：
- ✅ 检查系统环境
- ✅ 配置公司信息
- ✅ 生成示例数据
- ✅ 验证安装

#### 步骤2：了解界面

```
┌─────────────────────────────────────────────────────────────┐
│  氧化加工厂财务系统 V2.0                                  │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────────────────────────────────────────────┐   │
│  │                    今日概览                           │   │
│  │  待加工订单: 5个    今日收款: ¥3,000    待付款: ¥5,000│   │
│  └─────────────────────────────────────────────────────┘   │
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐                  │
│  │    订单管理     │  │    收支管理     │                  │
│  │  [待加工 3]    │  │  [本月收入 ¥X] │                  │
│  │  [加工中 2]    │  │  [本月支出 ¥Y] │                  │
│  └─────────────────┘  └─────────────────┘                  │
│                                                             │
│  ┌─────────────────┐  ┌─────────────────┐                  │
│  │    客户管理     │  │    供应商管理   │                  │
│  │     6 家       │  │     6 家       │                  │
│  └─────────────────┘  └─────────────────┘                  │
│                                                             │
├─────────────────────────────────────────────────────────────┤
│  [首页] [订单] [收支] [银行] [报表] [数据] [设置]           │
└─────────────────────────────────────────────────────────────┘
```

### 3.2 日常操作流程

#### 每日必做

```
早上：
  1. 打开系统，查看今日待办
  2. 确认新订单信息
  
白天：
  3. 记录收到的货款
  4. 记录支出的费用
  5. 更新订单状态
  
晚上：
  6. 查看当日收支汇总
  7. 备份数据（自动）
```

#### 每月必做

```
1. 核对银行流水
2. 生成月度报表
3. 统计客户应收
4. 统计供应商应付
5. 数据备份
```

---

## 4. 客户管理

### 4.1 添加客户

```
路径：客户管理 → 添加客户

必填信息：
  • 客户名称：必填
  • 联系人：选填
  • 电话：选填
  • 地址：选填
  • 信用额度：默认0
  
可选信息：
  • 备注：记录特殊要求
```

### 4.2 客户分类

| 类型 | 说明 | 示例 |
|------|------|------|
| 月结客户 | 每月结算 | 大型企业 |
| 现金客户 | 现款交易 | 小作坊 |
| 预付客户 | 先付款后加工 | 新客户 |

### 4.3 客户列表操作

```
┌────────────────────────────────────────┐
│ 客户名称        │ 联系人 │ 信用额度  │
├────────────────────────────────────────┤
│ 优质客户有限公司│ 张经理 │ ¥100,000 │
│ 新兴科技股份    │ 李总   │ ¥50,000  │
└────────────────────────────────────────┘

操作：
  • 点击查看详情
  • 点击编辑修改
  • 点击查看订单历史
  • 点击删除（需确认）
```

---

## 5. 供应商管理

### 5.1 供应商类型

| 类型 | 说明 | 示例 |
|------|------|------|
| 化工原料商 | 提供三酸、片碱等 | 化工贸易公司 |
| 委外加工商 | 喷砂、拉丝等 | 喷砂加工厂 |
| 工装设备商 | 提供挂具等 | 五金制造厂 |
| 其他 | 房租、水电等 | 物业公司 |

### 5.2 添加供应商

```
路径：供应商管理 → 添加供应商

必填信息：
  • 供应商名称：必填
  • 业务类型：必选
  • 联系人：选填
  • 电话：选填
  
可选信息：
  • 地址
  • 备注
```

---

## 6. 订单管理

### 6.1 创建订单

```
路径：订单管理 → 新建订单

步骤1：选择客户
  └── 从已有客户选择，或新建客户

步骤2：填写物品信息
  ├── 物品描述：铝型材6063氧化
  ├── 数量：100
  ├── 计价单位：米
  └── 单价：5.00元/米

步骤3：选择工序
  ├── 喷砂 ☑
  ├── 拉丝 ☐
  ├── 抛光 ☐
  └── 氧化 ☑（必选）

步骤4：委外设置
  └── 如果喷砂委外加工，勾选并选择供应商
```

### 6.2 计价方式说明

| 计价方式 | 适用物品 | 输入示例 |
|---------|---------|---------|
| **件** | 螺丝、螺母等小零件 | 数量：5000，单价：0.1元 |
| **条** | 铝条、钢条 | 数量：100，单价：2元 |
| **只** | 把手、拉手 | 数量：200，单价：5元 |
| **个** | 配件、组件 | 数量：50，单价：10元 |
| **米** | 铝型材、管材 | 数量：100，单价：5元 |
| **公斤** | 板材、型材 | 数量：200，单价：1元 |
| **平方米** | 大板、面板 | 数量：10，单价：50元 |

### 6.3 工序说明

```
喷砂 → 拉丝 → 抛光 → 氧化
  ↑       ↑       ↑       ↑
  │       │       │       └── 最后工序，本厂完成
  │       │       └────────── 可委外加工
  │       └────────────────── 可委外加工
  └────────────────────────── 可委外加工
```

### 6.4 订单状态

| 状态 | 说明 | 下一步 |
|------|------|--------|
| 待加工 | 新订单 | 开始加工 |
| 加工中 | 正在加工 | 完工 |
| 委外中 | 委外加工中 | 收回 |
| 已完工 | 加工完成 | 交付客户 |
| 已交付 | 客户取货 | 等待收款 |
| 已收款 | 款项到账 | 完成 |

### 6.5 订单金额计算

```
公式：
  订单金额 = 数量 × 单价
  
  委外成本 = 订单金额 × 委外比例（通常20-30%）
  
  预计利润 = 订单金额 - 委外成本
```

**示例：**
```
物品：铝型材6063
数量：100米
单价：5元/米
工序：喷砂 + 氧化
委外：喷砂委外（25%）

计算：
  订单金额 = 100 × 5 = 5,000元
  委外成本 = 5,000 × 25% = 1,250元
  预计利润 = 5,000 - 1,250 = 3,750元
```

---

## 7. 收入管理

### 7.1 收入类型

| 类型 | 说明 | 示例 |
|------|------|------|
| **订单收款** | 客户支付加工费 | 订单OX202401001收款 |
| **预收款** | 客户预付加工费 | 预收款10,000元 |
| **其他收入** | 利息、补贴等 | 银行利息128元 |

### 7.2 记录收款

```
路径：收支管理 → 收入 → 添加收入

步骤1：选择客户
  └── 从列表选择，或输入新客户名

步骤2：填写金额
  ├── 金额：5,000元
  └── 收入日期：2024-02-15

步骤3：选择账户
  ├── G银行（有发票）☑
  └── N银行（现金/微信）☐

步骤4：关联订单（可选）
  └── 如果是订单收款，关联对应订单
  └── 如果是预收款，不关联
```

### 7.3 收入分配

**一笔付款对应一个订单**
```
收入金额：5,000元
关联订单：OX202401001
分配：100% → OX202401001
```

**一笔付款对应多个订单**
```
收入金额：15,000元
关联订单：
  ├── OX202401001：5,000元（33%）
  ├── OX202401002：6,000元（40%）
  └── OX202401003：4,000元（27%）
```

**预收款（暂不关联）**
```
收入金额：10,000元
关联订单：无
备注：预收款，待后续分配到具体订单
```

### 7.4 银行账户选择

| 情况 | 选择 | 原因 |
|------|------|------|
| 大额交易（>5000元） | G银行 | 正式交易，需要发票 |
| 有发票的交易 | G银行 | 正式交易 |
| 小额交易（<1000元） | N银行 | 现金/微信 |
| 无发票交易 | N银行 | 现金交易 |
| 客户微信付款 | N银行 | 微信收款 |

---

## 8. 支出管理

### 8.1 支出类型

| 类型 | 说明 | 常见项目 |
|------|------|---------|
| **房租** | 厂房租金 | 月租8,500元 |
| **水电费** | 水电支出 | 电费为主 |
| **原料** | 生产原料 | 三酸、片碱、亚钠、色粉等 |
| **委外加工** | 委外费用 | 喷砂、拉丝、抛光 |
| **工装** | 生产工具 | 挂具、夹具 |
| **日常** | 日常支出 | 办公用品、维修等 |
| **工资** | 员工工资 | 月薪支出 |
| **其他** | 其他支出 | - |

### 8.2 记录支出

```
路径：收支管理 → 支出 → 添加支出

步骤1：选择类型
  └── 房租 / 水电费 / 原料 / 委外加工 / ...

步骤2：填写金额
  ├── 金额：5,000元
  └── 支出日期：2024-02-15

步骤3：选择供应商
  └── 选择已有供应商，或输入新供应商

步骤4：选择账户
  ├── G银行（有发票）☑
  └── N银行（现金/微信）☐

步骤5：关联订单（委外加工时）
  └── 如果是委外加工，关联对应订单
```

### 8.3 原料采购示例

| 原料类型 | 用途 | 采购频率 | 单次金额 |
|---------|------|---------|---------|
| 三酸 | 氧化用 | 每月1-2次 | 3,000-8,000元 |
| 片碱 | 除油用 | 每月1次 | 800-2,000元 |
| 亚钠 | 氧化用 | 每月1次 | 500-1,500元 |
| 色粉 | 着色用 | 每月1次 | 800-3,000元 |

### 8.4 委外加工示例

```
场景：订单OX202401001需要喷砂委外

操作：
1. 创建订单时选择"喷砂委外"
2. 记录委外供应商：喷砂加工厂
3. 委外成本自动计算（订单金额的20-30%）

生成支出：
- 类型：委外加工费
- 供应商：喷砂加工厂
- 金额：1,250元
- 关联订单：OX202401001
```

---

## 9. 银行账户

### 9.1 账户类型

| 类型 | 用途 | 特点 |
|------|------|------|
| **G银行** | 正式交易 | 有发票、对公账户 |
| **N银行** | 现金交易 | 微信绑定、小额支付 |

### 9.2 添加账户

```
路径：银行管理 → 添加账户

步骤1：选择类型
  └── G银行 / N银行

步骤2：填写信息
  ├── 账户名称：G银行对公账户
  ├── 账户号码：6222****1234
  └── 初始余额：150,000元

步骤3：备注
  └── 备注信息
```

### 9.3 银行对账

```
路径：银行管理 → 对账

步骤1：下载银行流水
  └── 登录网银导出Excel

步骤2：导入流水
  └── 使用"数据导入"工具

步骤3：系统自动匹配
  └── 收入自动匹配客户
  └── 支出自动匹配供应商

步骤4：人工确认
  └── 确认匹配结果
  └── 处理未匹配项目
```

---

## 10. 财务报表

### 10.1 利润表

```
路径：报表 → 利润表

格式：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
                    2024年1月
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
收入项目
  加工收入                 ¥150,000.00
  其他收入                     ¥500.00
───────────────────────────────────────────
  收入合计                 ¥150,500.00

支出项目
  原料成本
    三酸                      ¥8,500.00
    片碱                      ¥2,000.00
    亚钠                      ¥1,200.00
    色粉                      ¥3,000.00
    原料小计                 ¥14,700.00

  委外加工
    喷砂                     ¥10,000.00
    拉丝                      ¥5,000.00
    委外小计                 ¥15,000.00

  固定费用
    房租                     ¥8,500.00
    水电费                   ¥4,500.00
    工资                    ¥30,000.00
    固定小计                 ¥43,000.00

  日常费用                   ¥5,800.00
───────────────────────────────────────────
  支出合计                  ¥78,500.00

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  净利润                   ¥72,000.00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 10.2 成本分析

```
路径：报表 → 结构成本分析

成本：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
成本项目           金额          占比
───────────────────────────────────────────
原料成本       ¥14,700.00     18.7%
委外加工       ¥15,000.00     19.1%
固定费用       ¥43,000.00     54.8%
日常费用        ¥5,800.00      7.4%
───────────────────────────────────────────
总计           ¥78,500.00    100.0%
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### 10.3 客户对账单

```
路径：报表 → 客户对账单

选择客户 → 生成对账单

格式：
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
           优质客户有限公司 对账单
           期间：2024年1月1日-31日
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

期初应收：¥20,000.00

本月新增订单：
  OX202401001  2024-01-05  ¥5,000.00
  OX202401008  2024-01-12  ¥8,000.00
  OX202401015  2024-01-20  ¥3,500.00
  小计                        ¥16,500.00

本月收款：
  2024-01-10  G银行        ¥5,000.00
  2024-01-25  G银行        ¥8,000.00
  小计                        ¥13,000.00

期末应收：¥23,500.00
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 11. 数据工具

### 11.1 数据导入

```bash
# 生成导入模板
python oxidation_finance_v20/tools/import_excel.py --template customers
python oxidation_finance_v20/tools/import_excel.py --template orders
python oxidation_finance_v20/tools/import_excel.py --template incomes
python oxidation_finance_v20/tools/import_excel.py --template expenses
python oxidation_finance_v20/tools/import_excel.py --template bank

# 导入数据
python oxidation_finance_v20/tools/import_excel.py --import customers.xlsx --type customers
python oxidation_finance_v20/tools/import_excel.py --import orders.xlsx --type orders
```

### 11.2 备份恢复

```bash
# 创建手动备份
python oxidation_finance_v20/tools/backup_restore.py --create

# 查看备份历史
python oxidation_finance_v20/tools/backup_restore.py --list

# 恢复到备份
python oxidation_finance_v20/tools/backup_restore.py --restore --index 1

# 验证数据库
python oxidation_finance_v20/tools/backup_restore.py --verify
```

### 11.3 初始化向导

```bash
# 重新初始化
python oxidation_finance_v20/tools/setup_wizard.py
```

---

## 12. 常见问题

### Q1：如何添加新客户？

**答：** 
1. 进入"客户管理"
2. 点击"添加客户"
3. 填写客户信息
4. 点击"保存"

### Q2：客户一次性付了多个订单的钱怎么办？

**答：**
1. 记录一笔收入
2. 在"分配到订单"中勾选多个订单
3. 输入每个订单的分配金额

### Q3：委外加工如何记录？

**答：**
1. 创建订单时，在"委外设置"中选择委外工序和供应商
2. 系统自动计算委外成本
3. 支出时选择"委外加工费"类型，关联对应订单

### Q4：G银行和N银行有什么区别？

**答：**

| 对比项 | G银行 | N银行 |
|-------|-------|-------|
| 用途 | 正式交易 | 现金交易 |
| 发票 | 有发票 | 无发票 |
| 金额 | 大额 | 小额 |
| 示例 | 客户公对公付款 | 微信收款、现金支出 |

### Q5：如何查看某个客户的订单历史？

**答：**
1. 进入"客户管理"
2. 点击客户名称
3. 查看"订单历史"标签

### Q6：数据丢失怎么办？

**答：**
1. 进入"数据工具"→"备份恢复"
2. 查看备份历史
3. 选择需要的备份版本
4. 点击"恢复"

### Q7：如何导出数据到Excel？

**答：**
1. 进入对应管理模块（如订单管理）
2. 点击"导出"按钮
3. 选择导出格式（Excel/CSV）
4. 保存文件

### Q8：系统支持多用户吗？

**答：** 当前版本不支持多用户，所有数据存储在本地文件。

### Q9：如何修改订单金额？

**答：**
1. 进入"订单管理"
2. 点击订单编号
3. 点击"编辑"
4. 修改数量或单价
5. 系统自动重新计算

### Q10：预收款如何后续分配？

**答：**
1. 进入"收支管理"→"收入"
2. 找到预收款记录
3. 点击"分配到订单"
4. 选择要分配的订单

---

## 附录

### 附录A：快捷键

| 快捷键 | 功能 |
|-------|------|
| Ctrl+N | 新建 |
| Ctrl+S | 保存 |
| Ctrl+C | 复制 |
| Ctrl+V | 粘贴 |
| Delete | 删除 |

### 附录B：术语表

| 术语 | 说明 |
|------|------|
| 委外加工 | 将部分工序交给其他工厂加工 |
| 预收款 | 客户先付款，后续分配到订单 |
| 信用额度 | 客户可以赊账的最高金额 |
| 计价单位 | 计算金额的单位（件/米/公斤等） |

### 附录C：技术支持

- **项目地址**：https://github.com/tel9980/cw
- **文档**：`氧化加工厂财务系统_V2.0_快速上手指南.md`
- **AGENTS.md**：开发者规范

---

*手册结束，祝您使用愉快！*
