# é¡¹ç›®ç»“æ„è¯´æ˜

## ç›®å½•ç»“æ„

```
oxidation_finance_v20/
â”‚
â”œâ”€â”€ models/                      # æ•°æ®æ¨¡å‹å±‚
â”‚   â”œâ”€â”€ __init__.py             # æ¨¡å‹æ¨¡å—å¯¼å‡º
â”‚   â””â”€â”€ business_models.py      # ä¸šåŠ¡æ•°æ®æ¨¡å‹å®šä¹‰
â”‚       â”œâ”€â”€ Customer            # å®¢æˆ·æ¨¡å‹
â”‚       â”œâ”€â”€ Supplier            # ä¾›åº”å•†æ¨¡å‹
â”‚       â”œâ”€â”€ ProcessingOrder     # åŠ å·¥è®¢å•æ¨¡å‹
â”‚       â”œâ”€â”€ Income              # æ”¶å…¥è®°å½•æ¨¡å‹
â”‚       â”œâ”€â”€ Expense             # æ”¯å‡ºè®°å½•æ¨¡å‹
â”‚       â”œâ”€â”€ BankAccount         # é“¶è¡Œè´¦æˆ·æ¨¡å‹
â”‚       â”œâ”€â”€ BankTransaction     # é“¶è¡Œäº¤æ˜“æ¨¡å‹
â”‚       â””â”€â”€ Enums               # æšä¸¾ç±»å‹
â”‚           â”œâ”€â”€ PricingUnit     # è®¡ä»·å•ä½
â”‚           â”œâ”€â”€ ProcessType     # å·¥åºç±»å‹
â”‚           â”œâ”€â”€ OrderStatus     # è®¢å•çŠ¶æ€
â”‚           â”œâ”€â”€ ExpenseType     # æ”¯å‡ºç±»å‹
â”‚           â””â”€â”€ BankType        # é“¶è¡Œç±»å‹
â”‚
â”œâ”€â”€ database/                    # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ __init__.py             # æ•°æ®åº“æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ schema.py               # æ•°æ®åº“è¡¨ç»“æ„å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ create_tables()    # åˆ›å»ºæ‰€æœ‰è¡¨
â”‚   â”‚   â””â”€â”€ drop_tables()      # åˆ é™¤æ‰€æœ‰è¡¨
â”‚   â””â”€â”€ db_manager.py           # æ•°æ®åº“ç®¡ç†å™¨
â”‚       â”œâ”€â”€ DatabaseManager     # ä¸»ç®¡ç†ç±»
â”‚       â”œâ”€â”€ å®¢æˆ·ç®¡ç†æ–¹æ³•
â”‚       â”œâ”€â”€ ä¾›åº”å•†ç®¡ç†æ–¹æ³•
â”‚       â”œâ”€â”€ è®¢å•ç®¡ç†æ–¹æ³•
â”‚       â”œâ”€â”€ æ”¶å…¥ç®¡ç†æ–¹æ³•
â”‚       â”œâ”€â”€ æ”¯å‡ºç®¡ç†æ–¹æ³•
â”‚       â”œâ”€â”€ é“¶è¡Œè´¦æˆ·ç®¡ç†æ–¹æ³•
â”‚       â””â”€â”€ é“¶è¡Œäº¤æ˜“ç®¡ç†æ–¹æ³•
â”‚
â”œâ”€â”€ business/                    # ä¸šåŠ¡é€»è¾‘å±‚ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ order_manager.py        # è®¢å•ç®¡ç†ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ finance_manager.py      # è´¢åŠ¡ç®¡ç†ä¸šåŠ¡é€»è¾‘
â”‚   â””â”€â”€ reconciliation.py       # å¯¹è´¦ä¸šåŠ¡é€»è¾‘
â”‚
â”œâ”€â”€ reports/                     # æŠ¥è¡¨ç”Ÿæˆå±‚ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ financial_reports.py    # è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆ
â”‚   â”œâ”€â”€ business_analysis.py    # ä¸šåŠ¡åˆ†ææŠ¥è¡¨
â”‚   â””â”€â”€ export_manager.py       # æŠ¥è¡¨å¯¼å‡ºç®¡ç†
â”‚
â”œâ”€â”€ config/                      # é…ç½®ç®¡ç†å±‚ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ config_manager.py       # é…ç½®ç®¡ç†å™¨
â”‚   â””â”€â”€ settings.py             # ç³»ç»Ÿè®¾ç½®
â”‚
â”œâ”€â”€ utils/                       # å·¥å…·å‡½æ•°å±‚ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ validators.py           # æ•°æ®éªŒè¯å·¥å…·
â”‚   â”œâ”€â”€ formatters.py           # æ ¼å¼åŒ–å·¥å…·
â”‚   â””â”€â”€ helpers.py              # è¾…åŠ©å‡½æ•°
â”‚
â”œâ”€â”€ scripts/                     # è„šæœ¬å·¥å…·
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ init_demo_data.py       # åˆå§‹åŒ–æ¼”ç¤ºæ•°æ®
â”‚   â””â”€â”€ verify_database.py      # éªŒè¯æ•°æ®åº“æ•°æ®
â”‚
â”œâ”€â”€ tests/                       # æµ‹è¯•æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ conftest.py             # Pytesté…ç½®å’Œfixtures
â”‚   â”œâ”€â”€ test_database.py        # æ•°æ®åº“æµ‹è¯•
â”‚   â”œâ”€â”€ test_models.py          # æ¨¡å‹æµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰
â”‚   â”œâ”€â”€ test_business.py        # ä¸šåŠ¡é€»è¾‘æµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰
â”‚   â””â”€â”€ test_properties.py      # å±æ€§æµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰
â”‚
â”œâ”€â”€ __init__.py                  # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ pytest.ini                   # Pytesté…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt             # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ README.md                    # é¡¹ç›®è¯´æ˜
â””â”€â”€ PROJECT_STRUCTURE.md         # æœ¬æ–‡ä»¶

```

## æ•°æ®åº“è¡¨ç»“æ„

### 1. customers (å®¢æˆ·è¡¨)
- id: ä¸»é”®
- name: å®¢æˆ·åç§°
- contact: è”ç³»äºº
- phone: ç”µè¯
- address: åœ°å€
- credit_limit: ä¿¡ç”¨é¢åº¦
- notes: å¤‡æ³¨
- created_at: åˆ›å»ºæ—¶é—´

### 2. suppliers (ä¾›åº”å•†è¡¨)
- id: ä¸»é”®
- name: ä¾›åº”å•†åç§°
- contact: è”ç³»äºº
- phone: ç”µè¯
- address: åœ°å€
- business_type: ä¸šåŠ¡ç±»å‹
- notes: å¤‡æ³¨
- created_at: åˆ›å»ºæ—¶é—´

### 3. processing_orders (åŠ å·¥è®¢å•è¡¨)
- id: ä¸»é”®
- order_no: è®¢å•ç¼–å·ï¼ˆå”¯ä¸€ï¼‰
- customer_id: å®¢æˆ·IDï¼ˆå¤–é”®ï¼‰
- customer_name: å®¢æˆ·åç§°
- item_description: ç‰©å“æè¿°
- quantity: æ•°é‡
- pricing_unit: è®¡ä»·å•ä½
- unit_price: å•ä»·
- processes: å·¥åºåˆ—è¡¨ï¼ˆJSONï¼‰
- outsourced_processes: å§”å¤–å·¥åºï¼ˆJSONï¼‰
- total_amount: æ€»é‡‘é¢
- outsourcing_cost: å§”å¤–æˆæœ¬
- status: è®¢å•çŠ¶æ€
- order_date: è®¢å•æ—¥æœŸ
- completion_date: å®Œå·¥æ—¥æœŸ
- delivery_date: äº¤ä»˜æ—¥æœŸ
- received_amount: å·²æ”¶é‡‘é¢
- notes: å¤‡æ³¨
- created_at: åˆ›å»ºæ—¶é—´
- updated_at: æ›´æ–°æ—¶é—´

### 4. incomes (æ”¶å…¥è®°å½•è¡¨)
- id: ä¸»é”®
- customer_id: å®¢æˆ·IDï¼ˆå¤–é”®ï¼‰
- customer_name: å®¢æˆ·åç§°
- amount: é‡‘é¢
- bank_type: é“¶è¡Œç±»å‹
- has_invoice: æ˜¯å¦æœ‰ç¥¨æ®
- related_orders: å…³è”è®¢å•ï¼ˆJSONï¼‰
- allocation: é‡‘é¢åˆ†é…ï¼ˆJSONï¼‰
- income_date: æ”¶å…¥æ—¥æœŸ
- notes: å¤‡æ³¨
- created_at: åˆ›å»ºæ—¶é—´

### 5. expenses (æ”¯å‡ºè®°å½•è¡¨)
- id: ä¸»é”®
- expense_type: æ”¯å‡ºç±»å‹
- supplier_id: ä¾›åº”å•†IDï¼ˆå¤–é”®ï¼‰
- supplier_name: ä¾›åº”å•†åç§°
- amount: é‡‘é¢
- bank_type: é“¶è¡Œç±»å‹
- has_invoice: æ˜¯å¦æœ‰ç¥¨æ®
- related_order_id: å…³è”è®¢å•IDï¼ˆå¤–é”®ï¼‰
- expense_date: æ”¯å‡ºæ—¥æœŸ
- description: æè¿°
- notes: å¤‡æ³¨
- created_at: åˆ›å»ºæ—¶é—´

### 6. bank_accounts (é“¶è¡Œè´¦æˆ·è¡¨)
- id: ä¸»é”®
- bank_type: é“¶è¡Œç±»å‹
- account_name: è´¦æˆ·åç§°
- account_number: è´¦æˆ·å·ç 
- balance: ä½™é¢
- notes: å¤‡æ³¨

### 7. bank_transactions (é“¶è¡Œäº¤æ˜“è®°å½•è¡¨)
- id: ä¸»é”®
- bank_type: é“¶è¡Œç±»å‹
- transaction_date: äº¤æ˜“æ—¥æœŸ
- amount: é‡‘é¢ï¼ˆæ­£æ•°ä¸ºæ”¶å…¥ï¼Œè´Ÿæ•°ä¸ºæ”¯å‡ºï¼‰
- counterparty: äº¤æ˜“å¯¹æ‰‹
- description: æè¿°
- matched: æ˜¯å¦å·²åŒ¹é…
- matched_income_id: åŒ¹é…çš„æ”¶å…¥IDï¼ˆå¤–é”®ï¼‰
- matched_expense_id: åŒ¹é…çš„æ”¯å‡ºIDï¼ˆå¤–é”®ï¼‰
- notes: å¤‡æ³¨
- created_at: åˆ›å»ºæ—¶é—´

## ç´¢å¼•

ä¸ºæé«˜æŸ¥è¯¢æ€§èƒ½ï¼Œåˆ›å»ºäº†ä»¥ä¸‹ç´¢å¼•ï¼š
- idx_orders_customer: è®¢å•æŒ‰å®¢æˆ·ç´¢å¼•
- idx_orders_date: è®¢å•æŒ‰æ—¥æœŸç´¢å¼•
- idx_orders_status: è®¢å•æŒ‰çŠ¶æ€ç´¢å¼•
- idx_incomes_customer: æ”¶å…¥æŒ‰å®¢æˆ·ç´¢å¼•
- idx_incomes_date: æ”¶å…¥æŒ‰æ—¥æœŸç´¢å¼•
- idx_expenses_supplier: æ”¯å‡ºæŒ‰ä¾›åº”å•†ç´¢å¼•
- idx_expenses_date: æ”¯å‡ºæŒ‰æ—¥æœŸç´¢å¼•
- idx_expenses_type: æ”¯å‡ºæŒ‰ç±»å‹ç´¢å¼•
- idx_transactions_date: äº¤æ˜“æŒ‰æ—¥æœŸç´¢å¼•
- idx_transactions_bank: äº¤æ˜“æŒ‰é“¶è¡Œç´¢å¼•

## æ•°æ®æµ

```
ç”¨æˆ·è¾“å…¥
    â†“
ä¸šåŠ¡é€»è¾‘å±‚ (business/)
    â†“
æ•°æ®è®¿é—®å±‚ (database/)
    â†“
SQLiteæ•°æ®åº“
    â†“
æ•°æ®æ¨¡å‹ (models/)
    â†“
æŠ¥è¡¨ç”Ÿæˆ (reports/)
    â†“
è¾“å‡ºç»“æœ
```

## å¼€å‘è¿›åº¦

### å·²å®Œæˆ âœ…
1. é¡¹ç›®ç›®å½•ç»“æ„æ­å»º
2. æ ¸å¿ƒæ•°æ®æ¨¡å‹å®šä¹‰
3. æ•°æ®åº“è¡¨ç»“æ„è®¾è®¡
4. æ•°æ®åº“ç®¡ç†å™¨å®ç°
5. æµ‹è¯•æ¡†æ¶é…ç½®
6. åŸºç¡€å•å…ƒæµ‹è¯•
7. æ¼”ç¤ºæ•°æ®åˆå§‹åŒ–è„šæœ¬
8. æ•°æ®åº“éªŒè¯è„šæœ¬

### è¿›è¡Œä¸­ ğŸ”„
- ä¸šåŠ¡é€»è¾‘å±‚å®ç°
- æŠ¥è¡¨ç”ŸæˆåŠŸèƒ½
- ç”¨æˆ·ç•Œé¢å¼€å‘

### å¾…å¼€å‘ ğŸ“‹
- é…ç½®ç®¡ç†åŠŸèƒ½
- æ•°æ®å¯¼å…¥å¯¼å‡º
- æƒé™ç®¡ç†
- æ“ä½œæ—¥å¿—
- å¤‡ä»½æ¢å¤

## ä½¿ç”¨è¯´æ˜

### 1. å®‰è£…ä¾èµ–
```bash
pip install -r requirements.txt
```

### 2. åˆå§‹åŒ–æ¼”ç¤ºæ•°æ®
```bash
python oxidation_finance_v20/scripts/init_demo_data.py
```

### 3. éªŒè¯æ•°æ®åº“
```bash
python oxidation_finance_v20/scripts/verify_database.py
```

### 4. è¿è¡Œæµ‹è¯•
```bash
pytest oxidation_finance_v20/tests/
```

## æŠ€æœ¯æ ˆ

- **Python**: 3.8+
- **æ•°æ®åº“**: SQLite3
- **æµ‹è¯•æ¡†æ¶**: pytest, hypothesis
- **æ•°æ®å¤„ç†**: openpyxl, python-dateutil
- **æ•°æ®ç±»å‹**: dataclasses, Decimal, Enum

## è®¾è®¡åŸåˆ™

1. **ç®€å•æ˜“ç”¨**: ä¸ºå°ç™½ä¼šè®¡è®¾è®¡ï¼Œé¿å…å¤æ‚çš„ä¸“ä¸šæœ¯è¯­
2. **æ•°æ®å®Œæ•´æ€§**: ä½¿ç”¨å¤–é”®çº¦æŸä¿è¯æ•°æ®ä¸€è‡´æ€§
3. **çµæ´»æ€§**: æ”¯æŒçµæ´»çš„æ”¶ä»˜æ¬¾åˆ†é…å’Œä¸šåŠ¡æµç¨‹
4. **å¯æµ‹è¯•æ€§**: å®Œæ•´çš„æµ‹è¯•è¦†ç›–ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•å’Œå±æ€§æµ‹è¯•
5. **å¯æ‰©å±•æ€§**: æ¨¡å—åŒ–è®¾è®¡ï¼Œä¾¿äºåŠŸèƒ½æ‰©å±•
